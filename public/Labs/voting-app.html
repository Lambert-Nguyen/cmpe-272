<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Preferences Voting App</title>
    
    <!-- jQuery Mobile CSS -->
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    
    <!-- jQuery and jQuery Mobile JS -->
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    
    <style>
        .vote-item {
            padding: 15px;
            margin: 10px 0;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .vote-question {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        .vote-buttons {
            display: flex;
            gap: 10px;
        }
        .vote-buttons .ui-btn {
            flex: 1;
            margin: 0;
        }
        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        .results-section {
            margin: 20px 0;
        }
        .result-item {
            padding: 12px;
            margin: 8px 0;
            background: #f5f5f5;
            border-radius: 6px;
            border-left: 4px solid #4CAF50;
        }
        .result-item.no {
            border-left-color: #f44336;
        }
        .result-label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .result-count {
            color: #666;
            font-size: 14px;
        }
        .stats-header {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .stats-number {
            font-size: 32px;
            font-weight: bold;
        }
        .stats-label {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- Home Page -->
    <div data-role="page" id="home">
        <div data-role="header" data-theme="b">
            <h1>Food Preferences Voting</h1>
            <a href="#results" class="ui-btn-right ui-btn ui-icon-bars ui-btn-icon-right">Results</a>
        </div>
        
        <div data-role="content">
            <div class="stats-header">
                <div class="stats-number" id="total-votes">0</div>
                <div class="stats-label">Total Votes</div>
            </div>
            
            <div id="voting-list">
                <!-- Voting items will be dynamically generated -->
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <a href="#results" data-role="button" data-theme="b" data-icon="bars">View All Results</a>
                <a href="#" data-role="button" data-theme="a" data-icon="refresh" id="reset-btn">Reset Votes</a>
            </div>
        </div>
    </div>
    
    <!-- Results Page -->
    <div data-role="page" id="results">
        <div data-role="header" data-theme="b">
            <a href="#home" data-icon="home" data-iconpos="notext" class="ui-btn-left">Home</a>
            <h1>Voting Results</h1>
        </div>
        
        <div data-role="content">
            <div class="stats-header">
                <div class="stats-number" id="results-total">0</div>
                <div class="stats-label">Total Votes Cast</div>
            </div>
            
            <div class="results-section">
                <h3 style="color: #4CAF50; margin-top: 20px;">üëç YES Votes</h3>
                <div id="yes-results">
                    <!-- Yes votes will be displayed here -->
                </div>
            </div>
            
            <div class="results-section">
                <h3 style="color: #f44336; margin-top: 20px;">üëé NO Votes</h3>
                <div id="no-results">
                    <!-- No votes will be displayed here -->
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <a href="#home" data-role="button" data-theme="b" data-icon="home">Back to Voting</a>
            </div>
        </div>
    </div>
    
    <script>
        // Preloaded voting choices
        const votingChoices = [
            { id: 1, question: "Do you like Pizza?" },
            { id: 2, question: "Do you like Sushi?" },
            { id: 3, question: "Do you like Ice Cream?" },
            { id: 4, question: "Do you like Tacos?" },
            { id: 5, question: "Do you like Burgers?" },
            { id: 6, question: "Do you like Pasta?" },
            { id: 7, question: "Do you like Chocolate?" },
            { id: 8, question: "Do you like Coffee?" },
            { id: 9, question: "Do you like Salad?" },
            { id: 10, question: "Do you like Cookies?" }
        ];
        
        // Initialize votes from localStorage or create empty object
        function getVotes() {
            const stored = localStorage.getItem('foodVotes');
            return stored ? JSON.parse(stored) : {};
        }
        
        function saveVotes(votes) {
            localStorage.setItem('foodVotes', JSON.stringify(votes));
        }
        
        // Get vote for a specific item
        function getVote(itemId) {
            const votes = getVotes();
            return votes[itemId] || null;
        }
        
        // Set vote for a specific item
        function setVote(itemId, vote) {
            const votes = getVotes();
            votes[itemId] = vote;
            saveVotes(votes);
        }
        
        // Get total vote count
        function getTotalVotes() {
            const votes = getVotes();
            return Object.keys(votes).length;
        }
        
        // Render voting list
        function renderVotingList() {
            const container = $('#voting-list');
            container.empty();
            
            votingChoices.forEach(item => {
                const vote = getVote(item.id);
                const voted = vote !== null;
                
                const voteItem = $('<div>').addClass('vote-item');
                
                const question = $('<div>').addClass('vote-question').text(item.question);
                voteItem.append(question);
                
                if (voted) {
                    const result = $('<div>').css({
                        'padding': '10px',
                        'background': vote === 'yes' ? '#e8f5e9' : '#ffebee',
                        'border-radius': '6px',
                        'text-align': 'center',
                        'font-weight': 'bold',
                        'color': vote === 'yes' ? '#4CAF50' : '#f44336'
                    }).text(`You voted: ${vote.toUpperCase()}`);
                    voteItem.append(result);
                    
                    const changeBtn = $('<a>')
                        .attr('href', '#')
                        .attr('data-role', 'button')
                        .attr('data-theme', 'a')
                        .attr('data-mini', 'true')
                        .text('Change Vote')
                        .on('click', function(e) {
                            e.preventDefault();
                            setVote(item.id, null);
                            renderVotingList();
                            updateStats();
                        });
                    voteItem.append(changeBtn);
                } else {
                    const buttons = $('<div>').addClass('vote-buttons');
                    
                    const yesBtn = $('<a>')
                        .attr('href', '#')
                        .attr('data-role', 'button')
                        .attr('data-theme', 'b')
                        .text('üëç YES')
                        .on('click', function(e) {
                            e.preventDefault();
                            setVote(item.id, 'yes');
                            renderVotingList();
                            updateStats();
                        });
                    
                    const noBtn = $('<a>')
                        .attr('href', '#')
                        .attr('data-role', 'button')
                        .attr('data-theme', 'a')
                        .text('üëé NO')
                        .on('click', function(e) {
                            e.preventDefault();
                            setVote(item.id, 'no');
                            renderVotingList();
                            updateStats();
                        });
                    
                    buttons.append(yesBtn).append(noBtn);
                    voteItem.append(buttons);
                }
                
                container.append(voteItem);
            });
            
            // Refresh jQuery Mobile styling
            container.trigger('create');
        }
        
        // Update statistics
        function updateStats() {
            const total = getTotalVotes();
            $('#total-votes').text(total);
            $('#results-total').text(total);
        }
        
        // Render results page
        function renderResults() {
            const votes = getVotes();
            const yesResults = $('#yes-results');
            const noResults = $('#no-results');
            
            yesResults.empty();
            noResults.empty();
            
            const yesItems = [];
            const noItems = [];
            
            votingChoices.forEach(item => {
                const vote = votes[item.id];
                if (vote === 'yes') {
                    yesItems.push(item);
                } else if (vote === 'no') {
                    noItems.push(item);
                }
            });
            
            if (yesItems.length === 0) {
                yesResults.append($('<div>').addClass('result-item').text('No YES votes yet.'));
            } else {
                yesItems.forEach(item => {
                    const resultItem = $('<div>').addClass('result-item');
                    resultItem.append($('<div>').addClass('result-label').text(item.question));
                    resultItem.append($('<div>').addClass('result-count').text('Voted: YES'));
                    yesResults.append(resultItem);
                });
            }
            
            if (noItems.length === 0) {
                noResults.append($('<div>').addClass('result-item no').text('No NO votes yet.'));
            } else {
                noItems.forEach(item => {
                    const resultItem = $('<div>').addClass('result-item no');
                    resultItem.append($('<div>').addClass('result-label').text(item.question));
                    resultItem.append($('<div>').addClass('result-count').text('Voted: NO'));
                    noResults.append(resultItem);
                });
            }
        }
        
        // Reset all votes
        function resetVotes() {
            if (confirm('Are you sure you want to reset all votes?')) {
                localStorage.removeItem('foodVotes');
                renderVotingList();
                updateStats();
                if ($.mobile.activePage.attr('id') === 'results') {
                    renderResults();
                }
            }
        }
        
        // Page initialization
        $(document).on('pagecreate', '#home', function() {
            renderVotingList();
            updateStats();
        });
        
        $(document).on('pagebeforeshow', '#results', function() {
            renderResults();
            updateStats();
        });
        
        // Reset button handler
        $('#reset-btn').on('click', function(e) {
            e.preventDefault();
            resetVotes();
        });
    </script>
</body>
</html>

